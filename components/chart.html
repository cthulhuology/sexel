<script>
    // Define the 'sexel-chart' component using the Sexel framework
    Sexel.tag('sexel-chart', ['type','labels','data','blurb','legend'], {
        ondraw: (self) => {
            const chartContainer = self.querySelector('#chart-container');
            chartContainer.innerHTML = '';  // Clear any previous chart

            // Create a canvas element for the chart
            const canvas = document.createElement('canvas');
            chartContainer.appendChild(canvas);

            // Get data, labels, and colors
	    const chartTitle = self.blurb() ? JSON.parse(self.blurb()) : { display: false }
            const chartData = JSON.parse(self.data());  	// Parse the data string into an array of objects
            const chartType = self.type() || 'bar';  // Default chart type is 'bar'
	    const chartLabels = self.labels() ? JSON.parse(self.labels()) : []
	    const chartLegend = self.legend() ? JSON.parse(self.legend()) : { display: false  }

            // Prepare the chart configuration
            const config = {
                type: chartType,  // Chart type (bar, line, pie, etc.)
                data: {
                    labels: chartLabels,
                    datasets: chartData,
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    },
		    plugins: {
			    legend: chartLegend,
			    title: chartTitle,
		   }
  		
		}
            };

            // Create the chart using Chart.js
            new Chart(canvas, config);
        }
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.min.js"></script>

<style>
    /* Basic styling for the chart container */
    .chart-container {
	background-color: var(--base-background);
        max-width: 600px;
        padding: 20px;
    }
</style>

<template id="sexel-chart">
    <div class="chart-container" id="chart-container"></div>
</template>

